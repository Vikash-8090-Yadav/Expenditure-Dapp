(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1058:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>es});var r=s(5155),a=s(2115),n=s(7173),i=s(9044),l=s(5868),d=s(9785),o=s(5968),c=s(9103),x=s(2713),u=s(9708),p=s(2085),m=s(2596),f=s(9688);function h(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,f.QP)((0,m.$)(t))}let g=(0,p.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),y=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:i=!1,...l}=e,d=i?u.DX:"button";return(0,r.jsx)(d,{className:h(g({variant:a,size:n,className:s})),ref:t,...l})});y.displayName="Button";let b=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:h("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});b.displayName="Card";let j=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:h("flex flex-col space-y-1.5 p-6",s),...a})});j.displayName="CardHeader";let w=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:h("text-2xl font-semibold leading-none tracking-tight",s),...a})});w.displayName="CardTitle";let v=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:h("text-sm text-muted-foreground",s),...a})});v.displayName="CardDescription";let N=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:h("p-6 pt-0",s),...a})});N.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:h("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter";let k=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:h("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});k.displayName="Input";var T=s(968);let A=(0,p.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),E=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(T.b,{ref:t,className:h(A(),s),...a})});E.displayName=T.b.displayName;let C=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:h("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});C.displayName="Textarea";var R=s(8550),S=s(6474),F=s(7863),M=s(5196);let D=R.bL;R.YJ;let P=R.WT,H=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(R.l9,{ref:t,className:h("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[a,(0,r.jsx)(R.In,{asChild:!0,children:(0,r.jsx)(S.A,{className:"h-4 w-4 opacity-50"})})]})});H.displayName=R.l9.displayName;let _=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(R.PP,{ref:t,className:h("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(F.A,{className:"h-4 w-4"})})});_.displayName=R.PP.displayName;let B=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(R.wn,{ref:t,className:h("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(S.A,{className:"h-4 w-4"})})});B.displayName=R.wn.displayName;let z=a.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...i}=e;return(0,r.jsx)(R.ZL,{children:(0,r.jsxs)(R.UC,{ref:t,className:h("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,r.jsx)(_,{}),(0,r.jsx)(R.LM,{className:h("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(B,{})]})})});z.displayName=R.UC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(R.JU,{ref:t,className:h("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=R.JU.displayName;let O=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(R.q7,{ref:t,className:h("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(R.VF,{children:(0,r.jsx)(M.A,{className:"h-4 w-4"})})}),(0,r.jsx)(R.p4,{children:a})]})});O.displayName=R.q7.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(R.wv,{ref:t,className:h("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=R.wv.displayName;var V=s(8652),q=s(3087);let U="0x96c00DbB128609D01d7A8945E19aC0fD6309A509",I=JSON.parse('{"HV":[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"address","name":"destinationAddress","type":"address"}],"name":"ExpenseAccepted","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"title","type":"string"},{"indexed":false,"internalType":"string","name":"description","type":"string"},{"indexed":false,"internalType":"string","name":"category","type":"string"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"address","name":"destinationAddress","type":"address"},{"indexed":false,"internalType":"address","name":"createdBy","type":"address"}],"name":"ExpenseCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"}],"name":"ExpenseRejected","type":"event"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"acceptExpense","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"string","name":"_title","type":"string"},{"internalType":"string","name":"_description","type":"string"},{"internalType":"string","name":"_category","type":"string"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"address","name":"_destinationAddress","type":"address"}],"name":"createExpense","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"expenseCounter","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"expenses","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"title","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"string","name":"category","type":"string"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"destinationAddress","type":"address"},{"internalType":"address","name":"createdBy","type":"address"},{"internalType":"bool","name":"isAccepted","type":"bool"},{"internalType":"bool","name":"isRejected","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"expensesByCreator","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getExpense","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"title","type":"string"},{"internalType":"string","name":"description","type":"string"},{"internalType":"string","name":"category","type":"string"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"destinationAddress","type":"address"},{"internalType":"address","name":"createdBy","type":"address"},{"internalType":"bool","name":"isAccepted","type":"bool"},{"internalType":"bool","name":"isRejected","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_creator","type":"address"}],"name":"getExpensesByCreator","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"rejectExpense","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]}');var W=s(6380);function X(e){let{onAddExpense:t}=e,[s,l]=(0,a.useState)(""),[d,o]=(0,a.useState)(""),[c,x]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),T=async e=>{if(e.preventDefault(),!s||!c||!u||!m){W.oR.error("Please fill in all required fields");return}try{if(g(!0),!V.PW(m)){W.oR.error("Please enter a valid Ethereum address"),g(!1);return}if(!window.ethereum)throw Error("Please install MetaMask or another Ethereum wallet");let e=new n.j(window.ethereum);await e.send("eth_requestAccounts",[]);let r=e.getSigner(),a=i.g5(u),h=new q.NZ(U,I.HV,r),y=await h.createExpense(s,d,c,a,m),b=await y.wait();1===b.status?(W.oR.success("Expense added successfully!"),t({title:s,description:d,category:c,amount:u,destinationAddress:m}),l(""),o(""),x(""),p(""),f("")):W.oR.error("Transaction failed. Please try again.")}catch(e){console.error("Error adding expense:",e),W.oR.error("Failed to add expense. See console for details.")}finally{g(!1)}};return(0,r.jsxs)(b,{children:[(0,r.jsxs)(j,{children:[(0,r.jsx)(w,{children:"Add New Expense"}),(0,r.jsx)(v,{children:"Fill in the details to add a new expense to your tracker"})]}),(0,r.jsx)(N,{children:(0,r.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E,{htmlFor:"title",children:"Title *"}),(0,r.jsx)(k,{id:"title",placeholder:"Expense title",value:s,onChange:e=>l(e.target.value),required:!0,disabled:h})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E,{htmlFor:"description",children:"Description"}),(0,r.jsx)(C,{id:"description",placeholder:"Add more details about this expense",value:d,onChange:e=>o(e.target.value),rows:3,disabled:h})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E,{htmlFor:"category",children:"Category *"}),(0,r.jsxs)(D,{value:c,onValueChange:x,disabled:h,children:[(0,r.jsx)(H,{id:"category",children:(0,r.jsx)(P,{placeholder:"Select category"})}),(0,r.jsxs)(z,{children:[(0,r.jsx)(O,{value:"Food",children:"Food"}),(0,r.jsx)(O,{value:"Housing",children:"Housing"}),(0,r.jsx)(O,{value:"Transportation",children:"Transportation"}),(0,r.jsx)(O,{value:"Entertainment",children:"Entertainment"}),(0,r.jsx)(O,{value:"Utilities",children:"Utilities"}),(0,r.jsx)(O,{value:"Healthcare",children:"Healthcare"}),(0,r.jsx)(O,{value:"Personal",children:"Personal"}),(0,r.jsx)(O,{value:"Education",children:"Education"}),(0,r.jsx)(O,{value:"Other",children:"Other"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E,{htmlFor:"amount",children:"Amount (CFX) *"}),(0,r.jsx)(k,{id:"amount",type:"number",step:"0.0001",min:"0",placeholder:"0.00",value:u,onChange:e=>p(e.target.value),required:!0,disabled:h})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E,{htmlFor:"destination",children:"Destination Address *"}),(0,r.jsx)(k,{id:"destination",placeholder:"0x...",value:m,onChange:e=>f(e.target.value),required:!0,disabled:h})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(y,{type:"submit",disabled:h,className:"relative",children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"opacity-0",children:"Add Expense"}),(0,r.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}):"Add Expense"})})]})}),(0,r.jsx)(W.N9,{position:"top-right",autoClose:5e3})]})}s(5716);let Y=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:h("w-full caption-bottom text-sm",s),...a})})});Y.displayName="Table";let J=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:h("[&_tr]:border-b",s),...a})});J.displayName="TableHeader";let L=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:h("[&_tr:last-child]:border-0",s),...a})});L.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:h("bg-primary font-medium text-primary-foreground",s),...a})}).displayName="TableFooter";let Z=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:h("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});Z.displayName="TableRow";let G=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:h("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});G.displayName="TableHead";let Q=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:h("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});Q.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:h("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";let $=(0,p.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function K(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:h($({variant:s}),t),...a})}function ee(e){let{expenses:t,setExpenses:s,onApproveExpense:l,onDeclineExpense:d}=e,[o,c]=(0,a.useState)(!1),[x,u]=(0,a.useState)("0"),[p,m]=(0,a.useState)({}),[f,h]=(0,a.useState)({});(0,a.useEffect)(()=>{(async()=>{if(!window.ethereum){console.error("Please install MetaMask or another Ethereum wallet");return}let e=new n.j(window.ethereum),t=e.getSigner(),r=new q.NZ(U,I.HV,t);try{let a=await t.getAddress();c("0x45b95a5549111e013e6b9a8d45951362a9f0793f"===a.toLowerCase());let n=await e.getBalance(U);u(i.ck(n));let l=await r.expenseCounter(),d=await Promise.all(Array.from({length:Number(l)},async(e,t)=>{let s=await r.getExpense(t+1);return{id:Number(s.id),title:s.title,description:s.description,category:s.category,amount:i.ck(s.amount),date:new Date().toISOString().split("T")[0],destinationAddress:s.destinationAddress,isAccepted:s.isAccepted,isRejected:s.isRejected}}));s(d)}catch(e){console.error("Error fetching expenses:",e)}})()},[s]);let g=async e=>{m(t=>({...t,[e]:!0}));try{await l(e)}finally{m(t=>({...t,[e]:!1}))}},k=async e=>{h(t=>({...t,[e]:!0}));try{await d(e)}finally{h(t=>({...t,[e]:!1}))}},T=e=>{let t={Food:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",Housing:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",Transportation:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",Entertainment:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",Utilities:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",Healthcare:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",Personal:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",Education:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",Other:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"};return t[e]||t.Other};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Expense Overview"}),(0,r.jsx)("div",{className:"flex space-x-3",children:(0,r.jsx)(b,{className:"w-auto",children:(0,r.jsxs)(N,{className:"p-3",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Contract Balance"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[x," CFX"]})]})})})]}),(0,r.jsxs)(b,{children:[(0,r.jsxs)(j,{children:[(0,r.jsx)(w,{children:"Recent Expenses"}),(0,r.jsx)(v,{children:o?"As the owner, you can approve or reject expenses":"You can view all expenses here"})]}),(0,r.jsx)(N,{children:(0,r.jsxs)(Y,{children:[(0,r.jsx)(J,{children:(0,r.jsxs)(Z,{children:[(0,r.jsx)(G,{children:"Title"}),(0,r.jsx)(G,{children:"Category"}),(0,r.jsx)(G,{children:"Date"}),(0,r.jsx)(G,{className:"text-right",children:"Amount (CFX)"}),(0,r.jsx)(G,{children:"Actions"})]})}),(0,r.jsx)(L,{children:t.length>0?t.map(e=>(0,r.jsxs)(Z,{children:[(0,r.jsxs)(Q,{className:"font-medium",children:[(0,r.jsx)("div",{children:e.title}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description}),e.destinationAddress&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:["To: ",e.destinationAddress]})]}),(0,r.jsx)(Q,{children:(0,r.jsx)(K,{variant:"outline",className:T(e.category),children:e.category})}),(0,r.jsx)(Q,{children:e.date}),(0,r.jsx)(Q,{className:"text-right font-medium",children:e.amount}),(0,r.jsx)(Q,{children:e.isAccepted?(0,r.jsxs)("div",{className:"text-sm text-green-500",children:["Accepted -"," ",(0,r.jsx)("a",{href:"https://evmtestnet.confluxscan.net/tx/".concat(e.transactionHash),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Transaction"})]}):e.isRejected?(0,r.jsx)("div",{className:"text-sm text-red-500",children:"Rejected"}):o?(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(y,{size:"sm",onClick:()=>g(e.id),className:"bg-green-600 hover:bg-green-700 relative",disabled:p[e.id]||f[e.id],children:p[e.id]?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"opacity-0",children:"Approve"}),(0,r.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}):"Approve"}),(0,r.jsx)(y,{size:"sm",onClick:()=>k(e.id),variant:"destructive",className:"relative",disabled:p[e.id]||f[e.id],children:f[e.id]?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"opacity-0",children:"Decline"}),(0,r.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}):"Decline"})]}):(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Waiting for owner approval"})})]},e.id)):(0,r.jsx)(Z,{children:(0,r.jsx)(Q,{colSpan:5,className:"text-center py-6 text-muted-foreground",children:"No expenses found. Add your first expense to get started."})})})]})})]})]})}function et(e){let{expenses:t}=e,[s,l]=(0,a.useState)(t);(0,a.useEffect)(()=>{(async()=>{if(!window.ethereum){console.error("Please install MetaMask or another Ethereum wallet");return}let e=new n.j(window.ethereum).getSigner(),t=new q.NZ(U,I.HV,e);try{let s=await e.getAddress(),r=await t.getExpensesByCreator(s),a=await Promise.all(r.map(async e=>{let s=await t.getExpense(e);return{id:s.id.toNumber(),title:s.title,description:s.description,category:s.category,amount:i.ck(s.amount),date:new Date().toISOString().split("T")[0],destinationAddress:s.destinationAddress}}));l(a)}catch(e){console.error("Error fetching expenses:",e)}})()},[]);let d=e=>{let t={Food:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",Housing:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",Transportation:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",Entertainment:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",Utilities:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",Healthcare:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",Personal:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",Education:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",Other:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"};return t[e]||t.Other},o=s.reduce((e,t)=>e+Number.parseFloat(t.amount),0);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Your Expenses"}),(0,r.jsx)(b,{className:"w-auto",children:(0,r.jsxs)(N,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Expenses"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[o.toFixed(2)," CFX"]})]})})]}),(0,r.jsxs)(b,{children:[(0,r.jsxs)(j,{children:[(0,r.jsx)(w,{children:"Recent Expenses"}),(0,r.jsx)(v,{children:"A list of your recent expenses and their details"})]}),(0,r.jsx)(N,{children:(0,r.jsxs)(Y,{children:[(0,r.jsx)(J,{children:(0,r.jsxs)(Z,{children:[(0,r.jsx)(G,{children:"Title"}),(0,r.jsx)(G,{children:"Category"}),(0,r.jsx)(G,{children:"Date"}),(0,r.jsx)(G,{className:"text-right",children:"Amount (CFX)"})]})}),(0,r.jsx)(L,{children:s.length>0?s.map(e=>(0,r.jsxs)(Z,{children:[(0,r.jsxs)(Q,{className:"font-medium",children:[(0,r.jsx)("div",{children:e.title}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description}),e.destinationAddress&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:["To: ",e.destinationAddress]})]}),(0,r.jsx)(Q,{children:(0,r.jsx)(K,{variant:"outline",className:d(e.category),children:e.category})}),(0,r.jsx)(Q,{children:e.date}),(0,r.jsx)(Q,{className:"text-right font-medium",children:e.amount})]},e.id)):(0,r.jsx)(Z,{children:(0,r.jsx)(Q,{colSpan:5,className:"text-center py-6 text-muted-foreground",children:"No expenses found. Add your first expense to get started."})})})]})})]})]})}function es(){let[e,t]=(0,a.useState)(""),[s,u]=(0,a.useState)("0"),[p,m]=(0,a.useState)("expenses"),[f,h]=(0,a.useState)([{id:1,title:"Groceries",description:"Weekly grocery shopping",category:"Food",amount:"0.05",date:"2023-06-15",destinationAddress:"0x45B95a5549111e013E6b9a8D45951362A9f0793f"},{id:2,title:"Rent",description:"Monthly apartment rent",category:"Housing",amount:"0.5",date:"2023-06-01",destinationAddress:"0x45B95a5549111e013E6b9a8D45951362A9f0793f"},{id:3,title:"Internet Bill",description:"Monthly internet subscription",category:"Utilities",amount:"0.03",date:"2023-06-10",destinationAddress:"0x45B95a5549111e013E6b9a8D45951362A9f0793f"}]),g=async()=>{if(void 0!==window.ethereum)try{let e=await window.ethereum.request({method:"eth_requestAccounts"}),s=new n.j(window.ethereum);if(e.length>0){t(e[0]);let r=await s.getBalance(e[0]);u(i.ck(r).substring(0,6))}}catch(e){console.error("Error connecting to wallet:",e)}else alert("Please install MetaMask or another Ethereum wallet")},b=async t=>{if(!e){alert("Please connect your wallet first");return}let s=f.find(e=>e.id===t);if(!s||!s.destinationAddress){alert("Invalid expense or missing destination address");return}try{if(!window.ethereum)throw Error("Please install MetaMask or another Ethereum wallet");let e=new n.j(window.ethereum).getSigner(),t=await e.sendTransaction({to:s.destinationAddress,value:i.g5(s.amount)});alert("Transaction sent! Hash: ".concat(t.hash))}catch(e){console.error("Error approving expense:",e),alert("Failed to approve expense. See console for details.")}};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col bg-background",children:[(0,r.jsx)("header",{className:"border-b border-border shadow-sm",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(l.A,{className:"h-6 w-6 text-primary"}),(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"ExpenseTracker DApp"})]}),e?(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"wallet-badge px-3 py-1 rounded-md text-sm",children:(0,r.jsxs)("span",{className:"font-medium",children:[s," CFX"]})}),(0,r.jsx)("div",{className:"wallet-badge px-3 py-1 rounded-md text-sm",children:(0,r.jsxs)("span",{className:"font-medium",children:[e.substring(0,6),"...",e.substring(e.length-4)]})})]}):(0,r.jsxs)(y,{onClick:g,className:"flex items-center gap-2 bg-primary text-primary-foreground",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Connect Wallet"]})]})}),(0,r.jsxs)("div",{className:"flex flex-1",children:[(0,r.jsx)("aside",{className:"w-64 border-r border-border bg-muted/30 p-4",children:(0,r.jsxs)("nav",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4 text-foreground",children:"Dashboard"}),(0,r.jsxs)(y,{variant:"expenses"===p?"default":"ghost",className:"w-full justify-start sidebar-nav-button ".concat("expenses"===p?"bg-primary text-primary-foreground":"text-foreground"),onClick:()=>m("expenses"),children:[(0,r.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Expenses"]}),(0,r.jsxs)(y,{variant:"add-expense"===p?"default":"ghost",className:"w-full justify-start sidebar-nav-button ".concat("add-expense"===p?"bg-primary text-primary-foreground":"text-foreground"),onClick:()=>m("add-expense"),children:[(0,r.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Add Expense"]}),(0,r.jsxs)(y,{variant:"your-expenses"===p?"default":"ghost",className:"w-full justify-start sidebar-nav-button ".concat("your-expenses"===p?"bg-primary text-primary-foreground":"text-foreground"),onClick:()=>m("your-expenses"),children:[(0,r.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Your Expenses"]})]})}),(0,r.jsxs)("main",{className:"flex-1 p-6 bg-background",children:["expenses"===p&&(0,r.jsx)(ee,{expenses:f,setExpenses:h,onApproveExpense:b,onDeclineExpense:t=>{if(!e){alert("Please connect your wallet first");return}let s=f.findIndex(e=>e.id===t);if(-1===s){alert("Expense not found");return}let r=[...f];r.splice(s,1),h(r),alert("Expense declined and removed from the list")}}),"add-expense"===p&&(0,r.jsx)(X,{onAddExpense:e=>{let t={id:f.length+1,...e,date:new Date().toISOString().split("T")[0]};h([...f,t]),m("expenses")}}),"your-expenses"===p&&(0,r.jsx)(et,{expenses:f})]})]}),(0,r.jsx)("footer",{className:"border-t border-border py-6 bg-muted/30",children:(0,r.jsx)("div",{className:"container mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4 md:mb-0",children:[(0,r.jsx)(l.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"font-semibold text-foreground",children:"ExpenseTracker DApp"})]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["\xa9 ",new Date().getFullYear()," ExpenseTracker DApp. All rights reserved."]}),(0,r.jsxs)("div",{className:"flex space-x-4 mt-4 md:mt-0",children:[(0,r.jsx)("a",{href:"#",className:"text-sm text-muted-foreground hover:text-primary transition-colors",children:"Terms"}),(0,r.jsx)("a",{href:"#",className:"text-sm text-muted-foreground hover:text-primary transition-colors",children:"Privacy"}),(0,r.jsx)("a",{href:"#",className:"text-sm text-muted-foreground hover:text-primary transition-colors",children:"Contact"})]})]})})})]})}},7790:()=>{},9270:(e,t,s)=>{Promise.resolve().then(s.bind(s,1058))}},e=>{var t=t=>e(e.s=t);e.O(0,[797,540,441,684,358],()=>t(9270)),_N_E=e.O()}]);